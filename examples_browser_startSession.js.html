<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: examples/browser/startSession.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: examples/browser/startSession.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * 
 * 
 * &lt;h2>Browser start session example.&lt;/h2>
 * 
 * &lt;ul style="list-style: none;">
 *  &lt;li>  Click on source to see the script example.
 *  &lt;li>  Check the html example below for full example were jibb.js is the sdk.
 * &lt;/ul>
 * 
 * @example
 * &lt;!DOCTYPE html>
 * &lt;html>
 * &lt;body>
 *
 * &lt;h1>The script testing start session&lt;/h1>
 * &lt;script type="module">
 *    import * as JIBB from './jibb.js'
 *  &lt;/script>
 * &lt;script type="module" src="startSession.js">
 * &lt;/script>
 *
 * &lt;/body>
 * &lt;/html>
 * @name 0-Browser Start Session
 * @memberof Examples
 * 
 */




let MeetingAPI = JIBB.Meeting
let Auth = JIBB.Auth
let EventBus = JIBB.EventBus

const SurfaceType = {
	PAPER: "PAPER",
	WHITEBOARD: "WHITEBOARD",
}

function Config(apiKey) {
	this.apiKey = apiKey
	this.webURL = "https://app.jibb.ai"

	Auth.setApiKey(this.apiKey)
}

var meetingId = ""

function sleep(ms) {
	return new Promise((resolve) => setTimeout(resolve, ms))
}

function openInNewTab(url) {
	console.log("openInNewTab ...")
	// needs to be opened in a different app so that the script continue, browser might stop popup for this example, click allow popup.
	window.open(url, "_blank")
}

async function generateMeetingLink() {
	console.log("generating meeting link ...")

	let userToken = await Auth.getUserToken()

	let title = "start Session example"

	meetingId = await MeetingAPI.createMeeting({ title: title, isTemporary: true })

	let url = `${config.webURL}/remote/${meetingId}?user_token=${userToken}`
	return url
}

async function StartMeeting() {
	console.log("StartMeeting ...")

	let url = await generateMeetingLink()
	openInNewTab(url)
	// waiting for browser to open the URL, next calls needs to be done after the link is opened
	await sleep(10000)

	// getting the opened browser client ID
	let statusList = await EventBus.getClientStatusList()
	let clinetID = statusList[0].id

	// asking the browser for the availble camera Ids, make sure camera access is already allowed.
	let cameraList = await EventBus.getCameraList(clinetID)

	if (cameraList.length) {
		//preparing the startstream request
		// getting meeting token, required for any meeting related requests.
		let meetingToken = await MeetingAPI.getMeetingToken({ meetingId: meetingId, permission: 2 })
		let surfaceType = SurfaceType.WHITEBOARD
		//choose desired camera
		let cameraId = cameraList[1].id
		let req = {
			meetingId: meetingId,
			meetingToken: meetingToken,
			surfaceType: surfaceType,
			cameraId: cameraId,
			clientId: clinetID,
		}
		await EventBus.startStream(req)
	} else return Promise.reject("No Camera Access")
}

async function main() {
	StartMeeting()
}

let config = new Config("a2ec50bc-76cf-4d4c-8b54-b6b664f3815c")
main()
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="admin%250AThis%2520is%2520an%2520experimental%2520API.module_.html">admin
This is an experimental API.</a></li><li><a href="module-auth.html">auth</a></li><li><a href="module-EventBus.html">EventBus</a></li><li><a href="module-meeting.html">meeting</a></li><li><a href="Recording%250A%2520This%2520is%2520an%2520experimental%2520API.module_.html">Recording
 This is an experimental API.</a></li><li><a href="superadmin%250AThis%2520is%2520an%2520experimental%2520API.module_.html">superadmin
This is an experimental API.</a></li><li><a href="User%250AThis%2520is%2520an%2520experimental%2520API.module_.html">User
This is an experimental API.</a></li><li><a href="webexbot%250AThis%2520is%2520an%2520experimental%2520API.module_.html">webexbot
This is an experimental API.</a></li></ul><h3>Namespaces</h3><ul><li><a href="Examples.html">Examples</a></li></ul><h3>Classes</h3><ul><li><a href="module-auth-AuthClass.html">AuthClass</a></li><li><a href="Whiteboard.html">Whiteboard</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Thu Dec 01 2022 10:06:47 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
